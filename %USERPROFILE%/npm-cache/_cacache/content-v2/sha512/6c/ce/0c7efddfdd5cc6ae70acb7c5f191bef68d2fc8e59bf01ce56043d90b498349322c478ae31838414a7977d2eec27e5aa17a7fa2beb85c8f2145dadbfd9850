{"_id":"mock.js","_rev":"8-8ba1589ff7c410ed5fd6854f50703f99","name":"mock.js","description":"Lightweight Mock Object Testing For Javascript.","dist-tags":{"latest":"0.2.0"},"versions":{"0.1.0":{"name":"mock.js","version":"0.1.0","description":"Lightweight Mock Object Testing For Javascript.","author":{"name":"Chris Brand","email":"chris@cainsvault.com"},"repository":{"type":"git","url":"git://github.com/arcturial/mock/js.git"},"scripts":{"test":"vows ./test/mock.js"},"devDependencies":{"vows":"0.7.x"},"gitHead":"77cf19098a8e749676a6b7d4783ef58e25710cf8","_id":"mock.js@0.1.0","_shasum":"4913fbc38a8f4bd48a8a2f530f16668490eeba2b","_from":"./","_npmVersion":"1.4.28","_npmUser":{"name":"arcturial","email":"chris@cainsvault.com"},"maintainers":[{"name":"arcturial","email":"chris@cainsvault.com"}],"dist":{"shasum":"4913fbc38a8f4bd48a8a2f530f16668490eeba2b","tarball":"https://registry.npmjs.org/mock.js/-/mock.js-0.1.0.tgz","integrity":"sha512-mcBwtxAw9BTnLP2Fr67bEOMrJqJmyspVLxBa6eYWV+0jj9xUCXlSLJiW9VDQZ98RgeuvxH+aHM/9MW985kjjgw==","signatures":[{"keyid":"SHA256:jl3bwswu80PjjokCgh0o2w5c2U4LhQAE57gj9cz1kzA","sig":"MEUCIDQkkDEq4f+YtzqVkgXFNz+t6/J1VQ2g3Jhu66rg0y+QAiEAxBWWg4e0kwICsMWETNnA0CpzxmYhuzANqmA5erBizg4="}]}},"0.2.0":{"name":"mock.js","version":"0.2.0","description":"Lightweight Mock Object Testing For Javascript.","author":{"name":"Chris Brand","email":"chris@cainsvault.com"},"repository":{"type":"git","url":"git://github.com/arcturial/mock/js.git"},"scripts":{"test":"vows ./test/mock.js"},"devDependencies":{"vows":"0.7.x"},"gitHead":"cb18866bca63d5fa2e8797b475f5df4ed22eb939","_id":"mock.js@0.2.0","_shasum":"c0d6ee5e58c7b6902c3030462c1eff3bd33f8bdd","_from":"./","_npmVersion":"1.4.28","_npmUser":{"name":"arcturial","email":"chris@cainsvault.com"},"maintainers":[{"name":"arcturial","email":"chris@cainsvault.com"}],"dist":{"shasum":"c0d6ee5e58c7b6902c3030462c1eff3bd33f8bdd","tarball":"https://registry.npmjs.org/mock.js/-/mock.js-0.2.0.tgz","integrity":"sha512-DKI8Rh/h7Mma+fg+6aD0uUvwn0QXAjKG6q3s+lTaCboCQ/kvQMBN9IXRBzgEaz4aPiYoRnKU9jVsfZp0mHpWrQ==","signatures":[{"keyid":"SHA256:jl3bwswu80PjjokCgh0o2w5c2U4LhQAE57gj9cz1kzA","sig":"MEQCIHNfMb/AD9jcSS9QYDQZ5FyWzr43siidUvmz43y0qoaPAiAOOWkgKPqt7F5qQ7ejGaR5QRx/LrsHs5id9loWrT53cA=="}]}}},"readme":"Mock.js Testing Utility\r\n=================\r\n\r\nMaster: [![Build Status](https://secure.travis-ci.org/arcturial/mock.js.png?branch=master)](http://travis-ci.org/arcturial/mock.js)\r\n\r\nMock.js is a Javascript resource library that allows the user to\r\n'fake' certain Javascript objects in order to test their functionality\r\nproperly by assessing the flow of a Javascript function execution.\r\n\r\nTable of Contents\r\n-----------------\r\n* Instantiate Mock.js\r\n* Testing using called()\r\n* Testing using calledWith()\r\n* Testing using returnedWith()\r\n* Spy/Mock global methods\r\n* Releasing Mocks\r\n* Integration with a UnitTest Framework\r\n* License\r\n\r\n\r\n1. Instantiate Mock.js\r\n------------------\r\n\r\nMock.js hooks into an object like a spy and monitors certain assertions on the method:\r\n\r\n```javascript\r\nvar mocked = Mock.Spy(new Object, 'method1');\r\n```\r\n\r\nThis will create a spy on the 'Object' class for 'method1'.\r\n\r\n2. Testing using called()\r\n------------------\r\n\r\nThe function `called()` is used to test the amount of times a certain method is being called during a\r\nJavascript function execution.\r\n\r\nWe start out by creating our mocked object and methods and then calling the specific method we want to test.\r\n\r\n```javascript\r\nvar object = new Object()\r\n\r\nvar mocked = Mock.Spy(object, 'method1');\r\n\r\nobject.method1()\r\n```\r\n\r\nIn order to test the amount of times a certain function has been called, you can use mock_called as follows:\r\n\r\n```javascript\r\nmocked.called()\r\n```\r\n\r\nAt this point, called() will return 1 (the amount of times the method 'method1' has been called)\r\n\r\n3. Testing using calledWith()\r\n------------------\r\n\r\nSometimes we need to test the arguments a certain function is called with. We can accomplish this by using the `calledWith()` function.\r\n\r\nAgain, we create our mocked object.\r\n\r\n```javascript\r\nvar object = new Object()\r\n\r\nvar mocked = Mock.Spy(object, 'method1');\r\n```\r\n\r\nBut this time, we call 'method1' with some arguments.\r\n\r\n```javascript\r\nobject.method1(this, 'hello!')\r\n```\r\n\r\nAt this point, the assumption is that 'method1' was called with an 'Object' and 'string' as it's parameters...now let us test it.\r\n\r\n```javascript\r\nmocked.calledWith()\r\n```\r\n\r\nWe expect this call to return [this, 'hello1']. We can then use an absolute comparison (===) to compare the argument arrays.\r\n\r\n4. Testing using returnedWith()\r\n------------------\r\n\r\nSimilar to calledWith(), we might like to sometimes check if a function returned an expected result. We can achieve this using `returnedWith()`\r\n\r\nAgain, we create our mocked object...but this time we give the method a response.\r\n\r\n```javascript\r\nvar object = new Object()\r\n\r\nobject.method1 = function() { return 'hello'; }\r\n\r\nvar mocked = Mock.Spy(object, 'method1');\r\n```\r\n\r\nLet's call the method and see if returned what it should.\r\n\r\n```javascript\r\nobject.method1()\r\n```\r\n\r\nWe can now use the mocked object to assert the response of this method.\r\n\r\n```javascript\r\nmocked.returnedWith()\r\n```\r\n\r\nWe expect this call to return 'hello'. You might think that you don't have to even use a mock to determine this\r\nand can just call the function directly, but sometimes it's not possible to call functions directly...and then this\r\nfunction is very handy.\r\n\r\n5. Spy/Mock global methods\r\n------------------\r\n\r\nSometimes you need to spy on or overwrite methods such as jQuery.ajax, you can achieve this using a spy or consume().\r\nIn order to check if a global method was called, we can use a normal spy.\r\n\r\n```javascript\r\nvar spy = Mock.Spy(jQuery, \"ajax\");\r\n\r\njQuery.ajax({\"url\": \"example.js\"});\r\n\r\nalert(spy.called());\r\n```\r\n\r\nThis should output '1' in your browser, since the global method was called once. Now if we want to completely stop\r\najax requests while testing, but still test the function...we can utilize consume().\r\n\r\n```javascript\r\nvar spy = Mock.Spy(jQuery, \"ajax\");\r\n\r\nspy.consume('ajax result');\r\n\r\njQuery.ajax({\"url\": \"example.js\"});\r\n\r\nalert(spy.called());\r\n\r\nalert(spy.returnedWith());\r\n```\r\n\r\nCalling consume(result) means that a method will now return the specified result instead of completing it's normal flow. In this case,\r\nthe method was called once and it returnedWith 'ajax result' instead of trying to load `example.js`.\r\n\r\nThere are some cases where returning a predefined mock result isn't the best way to write your test.  In these scenarios, you can use consumeWithFake() instead to pass an executable method into the spy.\r\n\r\n```javascript\r\nvar spy = Mock.Spy(jQuery, \"ajax\");\r\n\r\nspy.consumeWithFake(function (opts) {\r\n  // do something with opts, then return a result\r\n});\r\n\r\njQuery.ajax({\"url\": \"example.js\"});\r\n\r\nalert(spy.called());\r\n\r\nalert(spy.returnedWith());\r\n\r\nCalling consumeWithFake() means that the method's arguments will now be passed to the mocked method, and returnedWith() will be that method's return value.\r\n\r\nNOTE: Unfortunately using `consume/consumeWithFake` only works on synchronous ajax request for now.\r\n\r\n6. Releasing Mocks\r\n------------------\r\n\r\nIt is good practice to `release()` mocks when you are done with them. If you don't release mocks and spies, they will sit around silently keeping track\r\nof method calls and potentially skewing results. Here is an example of a unreleased spy that will cause your test to fail.\r\n\r\n```javascript\r\nvar spy = Mock.Spy(jQuery, \"ajax\");\r\n\r\nspy.consume('ajax result');\r\n\r\njQuery.ajax({\"url\": \"example.js\"});\r\n```\r\n\r\nThis overrides the jQuery.ajax functions default behaviour, but if you then need the use jQuery.ajax generic functionality...it won't work.\r\n\r\n```javascript\r\njQuery.ajax({\"url\": \"example.js\"}).done(function() { alert(\"done\"); });\r\n```\r\n\r\nThis will fail, since the result you specified for jQuery.ajax is no longer an instance of the object, but instead a string. To stop this, you can simply call\r\n` spy.release() `...like this.\r\n\r\n```javascript\r\nvar spy = Mock.Spy(jQuery, \"ajax\");\r\n\r\nspy.consume('ajax result');\r\n\r\njQuery.ajax({\"url\": \"example.js\"});\r\n\r\nspy.release();\r\n\r\njQuery.ajax({\"url\": \"example.js\"}).done(function() { alert(\"done\"); });\r\n```\r\n\r\nSpies are automatically released in QUnit tests.\r\n\r\n\r\n7. Integration with a UnitTest Framework\r\n------------------\r\n\r\nYou can refer to the 'example/' directory for a simple integration with Javascript QUnit.\r\n\r\n8. License\r\n------------------\r\n\r\n* CopyrightÂ© 2012 Chris Brand\r\n* GNU General Public License\r\n* see http://www.gnu.org/licenses\r\n","maintainers":[{"name":"arcturial","email":"chris@cainsvault.com"}],"time":{"modified":"2022-06-20T02:14:19.184Z","created":"2014-10-31T18:00:04.339Z","0.1.0":"2014-10-31T18:00:04.339Z","0.2.0":"2014-10-31T18:16:05.502Z"},"repository":{"type":"git","url":"git://github.com/arcturial/mock/js.git"},"author":{"name":"Chris Brand","email":"chris@cainsvault.com"},"readmeFilename":"README.md","users":{"liuningww":true,"xfloops":true}}